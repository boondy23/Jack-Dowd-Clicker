<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jack Dowd Clicker</title>
  <style>
    /* [Styles unchanged] */
    /* ... your existing CSS here ... */
  </style>
</head>
<body>

<h1>Jack Dowd Clicker</h1>
<div id="version">Version 2.0</div>

<p id="score">Score: 0</p>

<div id="progress-tracker">
  Total Clicks: <span id="total-clicks">0</span><br />
  Total Points Earned: <span id="total-points">0</span><br />
  Time Played: <span id="time-played">0</span> seconds
</div>

<img src="jack.jpg" id="clickable-image" alt="Jack Dowd Face" />
<img src="rari.png" id="car-image" alt="Car" />
<img src="rdm.jpg" id="riley-image" alt="Riley" />

<h3 style="color:#ffcc00; margin-top: 10px; margin-bottom: 15px; text-align:center;">Shop</h3>
<div id="shop">
  <!-- [Buttons unchanged] -->
</div>

<div id="footer-features">featuring Greg and RDM</div>

<script>
let score = 0;
let pointsPerClick = 1;
let autoClickRate = 0;
let passiveMultiplier = 1;
let prestigeMultiplier = 1;
let isGoatMode = false;
let gregMode = false;

let totalClicks = 0;
let totalPointsEarned = 0;
let timePlayed = 0;

const img = document.getElementById('clickable-image');
const carImg = document.getElementById('car-image');
const rileyImg = document.getElementById('riley-image');
const scoreDisplay = document.getElementById('score');
const totalClicksDisplay = document.getElementById('total-clicks');
const totalPointsDisplay = document.getElementById('total-points');
const timePlayedDisplay = document.getElementById('time-played');

const counts = {
  boost: 0, autoClicker: 0, egoBoost: 0, mediaEmpire: 0,
  jacktok: 0, brain: 0, superBrain: 0, goatMode: 0,
  aliens: 0, viralVid: 0, cloningLab: 0, gregRdm: 0,
  drivingTest: 0, prestige: 0
};

// Load game data here early
function loadGame() {
  const data = JSON.parse(localStorage.getItem("jackDowdSave"));
  if (!data) return;

  score = data.score ?? 0;
  pointsPerClick = data.pointsPerClick ?? 1;
  autoClickRate = data.autoClickRate ?? 0;
  passiveMultiplier = data.passiveMultiplier ?? 1;
  prestigeMultiplier = data.prestigeMultiplier ?? 1;
  isGoatMode = data.isGoatMode ?? false;
  gregMode = data.gregMode ?? false;
  totalClicks = data.totalClicks ?? 0;
  totalPointsEarned = data.totalPointsEarned ?? 0;
  timePlayed = data.timePlayed ?? 0;

  if (data.counts) {
    for (let key in counts) {
      counts[key] = data.counts[key] ?? 0;
      updateCountDisplay(key);
    }
  }

  updateScoreDisplay();
  updateProgressTracker();
}

loadGame(); // ðŸ‘ˆ EARLY LOAD

function saveGame() {
  const saveData = {
    score, pointsPerClick, autoClickRate,
    passiveMultiplier, prestigeMultiplier,
    isGoatMode, gregMode,
    totalClicks, totalPointsEarned, timePlayed,
    counts
  };
  localStorage.setItem("jackDowdSave", JSON.stringify(saveData));
  console.log("Game saved");
}

function updateScoreDisplay() {
  scoreDisplay.textContent = carImg.style.display === 'inline-block' ?
    "Huzz: " + Math.floor(score) : "Score: " + Math.floor(score);
}

function updateCountDisplay(item) {
  const el = document.getElementById(`count-${item}`);
  if (el) el.textContent = counts[item];
}

function updateProgressTracker() {
  totalClicksDisplay.textContent = totalClicks;
  totalPointsDisplay.textContent = Math.floor(totalPointsEarned);
  timePlayedDisplay.textContent = timePlayed;
}

img.addEventListener('click', () => {
  let amount = pointsPerClick * prestigeMultiplier;
  if (isGoatMode) amount *= 5;
  if (gregMode) amount *= 10;
  score += amount;
  totalClicks++;
  totalPointsEarned += amount;
  updateScoreDisplay();
  updateProgressTracker();
  img.classList.add('shake');
  setTimeout(() => img.classList.remove('shake'), 500);
  saveGame(); // ðŸ‘ˆ Save after click
});

function buy(item) {
  const effects = {
    boost: { cost: 20, effect: () => pointsPerClick += 1 },
    autoClicker: { cost: 100, effect: () => autoClickRate += 1 },
    egoBoost: { cost: 200, effect: () => pointsPerClick *= 2 },
    mediaEmpire: { cost: 500, effect: () => autoClickRate += 10 },
    jacktok: { cost: 1000, effect: () => passiveMultiplier *= 1.5 },
    brain: { cost: 2000, effect: () => pointsPerClick += 100 },
    superBrain: { cost: 5000, effect: () => pointsPerClick += 1000 },
    goatMode: { cost: 5000, effect: () => {
      isGoatMode = true;
      setTimeout(() => isGoatMode = false, 10000);
    }},
    aliens: { cost: 10000, effect: () => {
      const bonus = Math.floor(Math.random() * 4001) + 1000;
      score += bonus;
      totalPointsEarned += bonus;
      alert(`Alien Dowds gave you +${bonus} points!`);
      updateScoreDisplay();
      updateProgressTracker();
    }},
    viralVid: { cost: 15000, effect: () => passiveMultiplier *= 3 },
    cloningLab: { cost: 25000, effect: () => autoClickRate *= 3 },
    gregRdm: { cost: 1, effect: () => {
      const originalSrc = img.src;
      if (Math.random() < 0.5) {
        gregMode = true;
        img.src = "greg.jpg";
        alert("You drew Greg! 10x income for 1 minute!");
        setTimeout(() => {
          gregMode = false;
          img.src = originalSrc;
        }, 60000);
      } else {
        img.style.display = 'none';
        rileyImg.style.display = 'block';
        setTimeout(() => {
          rileyImg.style.display = 'none';
          img.style.display = 'block';
        }, 5000);
        score = 0;
        pointsPerClick = 1;
        autoClickRate = 0;
        passiveMultiplier = 1;
        prestigeMultiplier = 1;
        totalClicks = 0;
        totalPointsEarned = 0;
        updateScoreDisplay();
        updateProgressTracker();
        alert("You drew RDM. Everything exploded.");
      }
    }},
    drivingTest: { cost: 50000, effect: () => {
      if (Math.random() < 0.10) {
        carImg.style.display = 'inline-block';
        document.querySelector('h1').textContent = "Jack's Huzz Clicker";
        updateScoreDisplay();
        alert("You passed the Driving Test! Car unlocked and name changed!");
      } else {
        alert("Driving Test failed. Try again!");
      }
    }},
    prestige: { cost: 1000000000, effect: () => {
      score = 0;
      pointsPerClick = 1;
      autoClickRate = 0;
      passiveMultiplier = 1;
      prestigeMultiplier *= 2;
      img.src = "presjack.jpg";
      alert("Prestiged! Your power has doubled.");
      updateScoreDisplay();
      updateProgressTracker();
    }}
  };

  const upgrade = effects[item];
  if (!upgrade) return;
  if (score >= upgrade.cost) {
    score -= upgrade.cost;
    upgrade.effect();
    counts[item]++;
    updateScoreDisplay();
    updateCountDisplay(item);
    updateProgressTracker();
    saveGame(); // ðŸ‘ˆ Save after purchase
  } else {
    alert("Not enough score!");
  }
}

setInterval(() => {
  let gain = autoClickRate * passiveMultiplier * prestigeMultiplier;
  if (isGoatMode) gain *= 5;
  if (gregMode) gain *= 10;
  score += gain;
  totalPointsEarned += gain;
  updateScoreDisplay();
  updateProgressTracker();
}, 1000);

setInterval(() => {
  timePlayed++;
  updateProgressTracker();
}, 1000);

// Auto-save every 5 seconds
setInterval(saveGame, 5000);
</script>

</body>
</html>
